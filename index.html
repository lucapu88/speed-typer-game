<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="shortcut icon" href="img/favicon.png" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SpeedyTyper</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
    />
  </head>
  <body>
    <nav>
      <select class="difficulty" name="difficulty" id="difficulty">
        <option value="0">Easy</option>
        <option value="1">Medium</option>
        <option value="2">Hard</option>
        <option class="difficulty-hero" value="3">Hero</option>
      </select>
      <div
        class="no-difficulty-in-exercise-mode"
        id="no-difficulty-in-exercise-mode"
        onclick="showExerciseModeExplanation()"
      >
        <span>i</span>
      </div>

      <span onclick="noChangeTimeWithHero()">
        <select class="select-time" name="time" id="select-time">
          <option class="time-60" value="60">60 seconds</option>
          <option class="time-30" value="30">30 seconds</option>
          <option class="sentences" value="long-free">Sentences</option>
          <option class="practice" value="free">Exercise</option>
        </select>
      </span>
    </nav>

    <main>
      <div class="game-container" id="game-container">
        <!-- BEFORE AND AFTER START -->
        <div class="before-starting" id="before-starting">
          <p id="game-over-text"></p>
          <p id="total-score-text"></p>
          <p id="difficulty-choise"></p>
          <p id="time-choise"></p>
          <span class="new-score" id="new-score"></span>
          <p id="hands-on-keyboard">Place your hands on the keyboard</p>
          <img
            id="img-hands-on-keyboard"
            src="img/keyboard-hands-position.png"
            alt="keyboard-hands-position"
          />

          <div
            class="choice-save-score-globally"
            id="choice-save-score-globally"
          >
            <p class="save-your-score">
              Save your score in the global ranking.
            </p>
            <div class="insert-nickname" id="insert-nickname">
              <p class="error-retry" id="error-retry">Error: retry!</p>
              <input
                type="text"
                id="nickname"
                class="nickname"
                placeholder="Insert a NickName and click save"
              />
              <button id="save-global-score" disabled>Save</button>
            </div>
          </div>
          <h1 class="success-save-db" id="success-save-db">Saved</h1>

          <button class="start" id="start" onclick="threeTwoOneCountdown()">
            Start
          </button>
        </div>

        <div class="countdownBeforeStarting" id="countdownBeforeStarting">
          <h1 id="count-number"></h1>
        </div>

        <!-- GAME STARTED -->
        <div class="game-started" id="game-started">
          <div class="info" id="info">
            <p>Remaining time: <span id="time"></span></p>
            <p>Score: <span id="score"></span></p>
          </div>
          <div class="info-sentences" id="info-sentences">
            <h3>Speed</h3>
            <p><span class="speed-letters" id="speed-letters"></span></p>
            <p><span class="speed-words" id="speed-words"></span></p>
          </div>

          <div class="game" id="game">
            <p>Type the following:</p>
            <h2
              class="h2-word-rewrite"
              id="h2-word-rewrite"
              ondragstart="return false;"
              ondrop="return false;"
            ></h2>
            <input type="text" id="input-word-rewrite" />
          </div>
          <div class="error-api exercise" id="error-api"></div>
        </div>
      </div>
      <!-- RANKING SCORES -->
      <div class="ranking-container" id="ranking">
        <h2 class="close-scores" onclick="toggleScore()">x</h2>
        <div class="btn-scores-group">
          <button class="global selected" id="global" onclick="showGlobal()">
            Global
          </button>
          <button class="local" id="local" onclick="showLocal()">Local</button>
        </div>
        <!-- GLOBALE -->
        <div class="global-ranking-container" id="global-ranking-container">
          <div class="scores-title">
            <h2>Global Best Scores</h2>
          </div>
          <div class="btns-difficulty-global-scores">
            <button class="global-easy selected-global" id="global-easy">
              Easy
            </button>
            <button class="global-medium" id="global-medium">Med.</button>
            <button class="global-hard" id="global-hard">Hard</button>
            <button class="global-hero" id="global-hero">Hero</button>
          </div>

          <div
            class="global-difficulty-container"
            id="global-difficulty-container"
          >
            <div class="easy-global-scores" id="easy-global-scores">
              <div class="seconds-30">
                <p class="g-seconds">30 seconds</p>
                <ul>
                  <li class="user">
                    1&#176;<span id="easy30-user1">user</span
                    ><span id="easy30-score1"> 0</span>
                  </li>
                  <li class="user">
                    2&#176;<span id="easy30-user2">user</span
                    ><span id="easy30-score2"> 0</span>
                  </li>
                  <li class="user">
                    3&#176;<span id="easy30-user3">user</span
                    ><span id="easy30-score3"> 0</span>
                  </li>
                  <li class="user">
                    4&#176;<span id="easy30-user4">user</span
                    ><span id="easy30-score4"> 0</span>
                  </li>
                  <li class="user">
                    5&#176;<span id="easy30-user5">user</span
                    ><span id="easy30-score5"> 0</span>
                  </li>
                </ul>
              </div>
              <div class="seconds-60">
                <p class="g-seconds">60 seconds</p>
                <ul>
                  <li class="user">
                    1&#176;<span id="easy60-user1">user</span
                    ><span id="easy60-score1"> 0</span>
                  </li>
                  <li class="user">
                    2&#176;<span id="easy60-user2">user</span
                    ><span id="easy60-score2"> 0</span>
                  </li>
                  <li class="user">
                    3&#176;<span id="easy60-user3">user</span
                    ><span id="easy60-score3"> 0</span>
                  </li>
                  <li class="user">
                    4&#176;<span id="easy60-user4">user</span
                    ><span id="easy60-score4"> 0</span>
                  </li>
                  <li class="user">
                    5&#176;<span id="easy60-user5">user</span
                    ><span id="easy60-score5"> 0</span>
                  </li>
                </ul>
              </div>
            </div>

            <div class="medium-global-scores" id="medium-global-scores">
              <div class="seconds-30">
                <p class="g-seconds">30 seconds</p>
                <ul>
                  <li class="user">
                    1&#176;<span id="medium30-user1">user</span
                    ><span id="medium30-score1"> 0</span>
                  </li>
                  <li class="user">
                    2&#176;<span id="medium30-user2">user</span
                    ><span id="medium30-score2"> 0</span>
                  </li>
                  <li class="user">
                    3&#176;<span id="medium30-user3">user</span
                    ><span id="medium30-score3"> 0</span>
                  </li>
                  <li class="user">
                    4&#176;<span id="medium30-user4">user</span
                    ><span id="medium30-score4"> 0</span>
                  </li>
                  <li class="user">
                    5&#176;<span id="medium30-user5">user</span
                    ><span id="medium30-score5"> 0</span>
                  </li>
                </ul>
              </div>
              <div class="seconds-60">
                <p class="g-seconds">60 seconds</p>
                <ul>
                  <li class="user">
                    1&#176;<span id="medium60-user1">user</span
                    ><span id="medium60-score1"> 0</span>
                  </li>
                  <li class="user">
                    2&#176;<span id="medium60-user2">user</span
                    ><span id="medium60-score2"> 0</span>
                  </li>
                  <li class="user">
                    3&#176;<span id="medium60-user3">user</span
                    ><span id="medium60-score3"> 0</span>
                  </li>
                  <li class="user">
                    4&#176;<span id="medium60-user4">user</span
                    ><span id="medium60-score4"> 0</span>
                  </li>
                  <li class="user">
                    5&#176;<span id="medium60-user5">user</span
                    ><span id="medium60-score5"> 0</span>
                  </li>
                </ul>
              </div>
            </div>

            <div class="hard-global-scores" id="hard-global-scores">
              <div class="seconds-30">
                <p class="g-seconds">30 seconds</p>
                <ul>
                  <li class="user">
                    1&#176;<span id="hard30-user1">user</span
                    ><span id="hard30-score1"> 0</span>
                  </li>
                  <li class="user">
                    2&#176;<span id="hard30-user2">user</span
                    ><span id="hard30-score2"> 0</span>
                  </li>
                  <li class="user">
                    3&#176;<span id="hard30-user3">user</span
                    ><span id="hard30-score3"> 0</span>
                  </li>
                  <li class="user">
                    4&#176;<span id="hard30-user4">user</span
                    ><span id="hard30-score4"> 0</span>
                  </li>
                  <li class="user">
                    5&#176;<span id="hard30-user5">user</span
                    ><span id="hard30-score5"> 0</span>
                  </li>
                </ul>
              </div>
              <div class="seconds-60">
                <p class="g-seconds">60 seconds</p>
                <ul>
                  <li class="user">
                    1&#176;<span id="hard60-user1">user</span
                    ><span id="hard60-score1"> 0</span>
                  </li>
                  <li class="user">
                    2&#176;<span id="hard60-user2">user</span
                    ><span id="hard60-score2"> 0</span>
                  </li>
                  <li class="user">
                    3&#176;<span id="hard60-user3">user</span
                    ><span id="hard60-score3"> 0</span>
                  </li>
                  <li class="user">
                    4&#176;<span id="hard60-user4">user</span
                    ><span id="hard60-score4"> 0</span>
                  </li>
                  <li class="user">
                    5&#176;<span id="hard60-user5">user</span
                    ><span id="hard60-score5"> 0</span>
                  </li>
                </ul>
              </div>
            </div>
            <div class="g-hero-container" id="g-hero-container">
              <ul>
                <li class="user">
                  1&#176;<span id="hero-user1">user</span
                  ><span id="hero-score1"> 0</span>
                </li>
                <li class="user">
                  2&#176;<span id="hero-user2">user</span
                  ><span id="hero-score2"> 0</span>
                </li>
                <li class="user">
                  3&#176;<span id="hero-user3">user</span
                  ><span id="hero-score3"> 0</span>
                </li>
                <li class="user">
                  4&#176;<span id="hero-user4">user</span
                  ><span id="hero-score4"> 0</span>
                </li>
                <li class="user">
                  5&#176;<span id="hero-user5">user</span
                  ><span id="hero-score5"> 0</span>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- LOCALE -->
        <div class="local-ranking-container" id="local-ranking-container">
          <div class="scores-title">
            <h2>Your Local Best Scores</h2>
          </div>

          <h3 class="easy" id="Easy">Easy:</h3>
          <ul>
            <li>30 seconds: <span id="easy-30"></span></li>
            <li>60 seconds: <span id="easy-60"></span></li>
          </ul>

          <h3 class="medium" id="Medium">Medium:</h3>
          <ul>
            <li>30 seconds: <span id="medium-30"></span></li>
            <li>60 seconds: <span id="medium-60"></span></li>
          </ul>

          <h3 class="hard" id="Hard">Hard:</h3>
          <ul>
            <li>30 seconds: <span id="hard-30"></span></li>
            <li>60 seconds: <span id="hard-60"></span></li>
          </ul>

          <h3 class="hero" id="Hero">Hero:<span id="hero"></span></h3>

          <button id="delete-all-scores" onclick="deleteAll()">
            Delete All
          </button>
        </div>
      </div>
    </main>
    <!-- HELPER -->
    <div class="helper-description" id="helper-description">
      <h2 class="close" onclick="toggleHelper()">x</h2>
      <h1>Istruction:</h1>
      <select class="languages" name="languages" id="languages">
        <option value="eng" id="eng">English</option>
        <option value="ita" id="ita">Italiano</option>
        <option value="fra" id="fra">Français</option>
        <option value="spa" id="spa">Español</option>
        <option value="deu" id="deu">Deutsch</option>
      </select>
      <p id="language-text">
        Improves the speed in typing on a pc keyboard (also works on mobile).
        The screen will show you random words and you will have to rewrite them,
        each word written correctly will give you a point. You can choose the
        difficulty (the harder it is, the longer the words) and the time (30 or
        60 seconds). Or you can just practice by practicing by choosing
        "Exercise/Sentences". You will have no time, no score and you will be
        able to write freely as long as you want. <br />
        With the HERO difficulty the words will be even longer and if you make a
        mistake you lose points, so be careful if you want to show that you have
        the balls. IMPORTANT: with the hero mode the time is only 60 seconds (to
        avoid nervous breakdowns and PC launched from the window).<br />
        Don't be fucking old using 2 fingers looking at your pc keyboard! you
        have 10 fingers, use them! learn to write with 10 fingers while looking
        at the screen like a real fucking pro!<br />
        <u
          >If you change the language, it will be changed only for the
          instructions and info of the Exercise mode. The words of the game will
          always be in English, but do not think that it penalizes you, on the
          contrary it will strengthen you!</u
        >
        trust me.<br />
        For bug reports or suggestions you can contact me at the email address:
        <span
          class="setting-info"
          id="info-email"
          onclick="copyToClipboard(event)"
          >lucarhcp88@hotmail.it</span
        >
        <small class="copied-to-cliboard" id="copied-to-cliboard"
          >COPIED TO CLIPBOARD</small
        >
        <br />
        <a
          class="setting-info social"
          href="https://www.linkedin.com/in/luca-caputo-1ba548140/"
          target="_blank"
          rel="noopener noreferrer"
        >
          <img class="linkedin-icon" src="img/linkedin.png" alt="linkedin" />
        </a>

        <a
          class="setting-info social"
          href="https://www.youtube.com/channel/UCVPzu5zrXrt8cgSEm73zVzA"
          target="_blank"
          rel="noopener noreferrer"
        >
          <img class="youtube-icon" src="img/Youtube.png" alt="youtube" />
        </a>
      </p>
    </div>
    <footer>
      <!-- SCORE -->
      <button class="show-hide-score" id="show-ranking" onclick="toggleScore()">
        <img src="img/score.png" alt="show/hide_score" />
      </button>
      <!-- AUDIO -->
      <audio loop id="audio">
        <source src="sounds/Pokemon-Center.mp3" type="audio/mpeg" />
        Your browser does not support the audio element.
      </audio>
      <button class="audio-btn" onclick="toggleAudio()">
        <img id="audio-icon" src="img/no-sound.png" alt="audio_play/pause" />
      </button>
      <!-- QUIT -->
      <button class="quit-game" id="quit-game" onclick="reloadGame()">
        Quit
      </button>
      <!-- HELP -->
      <button class="show-helper" onclick="toggleHelper()">
        <img src="img/settings.png" alt="settings" />
      </button>
    </footer>
    <script src="fake-db.js" charset="utf-8"></script>
    <script src="long-text.js" charset="utf-8"></script>
    <script src="main.js" charset="utf-8"></script>
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.6.8/firebase-app.js';
      import { getAnalytics } from 'https://www.gstatic.com/firebasejs/9.6.8/firebase-analytics.js';
      const nicknameInput = document.getElementById('nickname');
      const saveGlobalScoreBtn = document.getElementById('save-global-score');
      /*const prova = '';*/ console.log = function () {};
      const choiseSaveScoreGlobally = document.getElementById(
        'choice-save-score-globally'
      );
      const successSaveDb = document.getElementById('success-save-db');
      const errorSaveDb = document.getElementById('error-retry');

      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
      const firebaseConfig = {
        apiKey: `${window.docum}${window.lorem}${window.getelm}${window.gnigni}${window.lucap}${window.diff}${window.vader}${window.esghere}${window.selec}${window.addeve}`,
        authDomain: 'speedtyperdb.firebaseapp.com',
        projectId: 'speedtyperdb',
        storageBucket: 'speedtyperdb.appspot.com',
        messagingSenderId: '13131338',
        appId: '1:13131338:web:0e5e02b22be11ada5f90b3',
        measurementId: 'G-05JZHKH8TE',
        databaseURL:
          'https://speedtyperdb-default-rtdb.europe-west1.firebasedatabase.app',
      };

      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);

      import {
        getDatabase,
        ref,
        set,
        get,
        child,
        remove,
      } from 'https://www.gstatic.com/firebasejs/9.6.8/firebase-database.js';

      const db = getDatabase();
      const limit = 150;
      //REVIEW: tutta sta merda da qui sotto in poi va semplificata, se possibile.

      //EASY 30
      const user1Easy30 = document.getElementById('easy30-user1').innerText;
      const user2Easy30 = document.getElementById('easy30-user2').innerText;
      const user3Easy30 = document.getElementById('easy30-user3').innerText;
      const user4Easy30 = document.getElementById('easy30-user4').innerText;
      const user5Easy30 = document.getElementById('easy30-user5').innerText;
      const score1Easy30 = document.getElementById('easy30-score1').innerText;
      const score2Easy30 = document.getElementById('easy30-score2').innerText;
      const score3Easy30 = document.getElementById('easy30-score3').innerText;
      const score4Easy30 = document.getElementById('easy30-score4').innerText;
      const score5Easy30 = document.getElementById('easy30-score5').innerText;
      //EASY 60
      const user1Easy60 = document.getElementById('easy60-user1').innerText;
      const user2Easy60 = document.getElementById('easy60-user2').innerText;
      const user3Easy60 = document.getElementById('easy60-user3').innerText;
      const user4Easy60 = document.getElementById('easy60-user4').innerText;
      const user5Easy60 = document.getElementById('easy60-user5').innerText;
      const score1Easy60 = document.getElementById('easy60-score1').innerText;
      const score2Easy60 = document.getElementById('easy60-score2').innerText;
      const score3Easy60 = document.getElementById('easy60-score3').innerText;
      const score4Easy60 = document.getElementById('easy60-score4').innerText;
      const score5Easy60 = document.getElementById('easy60-score5').innerText;

      //MEDIUM 30
      const user1Med30 = document.getElementById('medium30-user1').innerText;
      const user2Med30 = document.getElementById('medium30-user2').innerText;
      const user3Med30 = document.getElementById('medium30-user3').innerText;
      const user4Med30 = document.getElementById('medium30-user4').innerText;
      const user5Med30 = document.getElementById('medium30-user5').innerText;
      const score1Med30 = document.getElementById('medium30-score1').innerText;
      const score2Med30 = document.getElementById('medium30-score2').innerText;
      const score3Med30 = document.getElementById('medium30-score3').innerText;
      const score4Med30 = document.getElementById('medium30-score4').innerText;
      const score5Med30 = document.getElementById('medium30-score5').innerText;
      //MEDIUM 60
      const user1Med60 = document.getElementById('medium60-user1').innerText;
      const user2Med60 = document.getElementById('medium60-user2').innerText;
      const user3Med60 = document.getElementById('medium60-user3').innerText;
      const user4Med60 = document.getElementById('medium60-user4').innerText;
      const user5Med60 = document.getElementById('medium60-user5').innerText;
      const score1Med60 = document.getElementById('medium60-score1').innerText;
      const score2Med60 = document.getElementById('medium60-score2').innerText;
      const score3Med60 = document.getElementById('medium60-score3').innerText;
      const score4Med60 = document.getElementById('medium60-score4').innerText;
      const score5Med60 = document.getElementById('medium60-score5').innerText;

      //HARD 30
      const user1Hard30 = document.getElementById('hard30-user1').innerText;
      const user2Hard30 = document.getElementById('hard30-user2').innerText;
      const user3Hard30 = document.getElementById('hard30-user3').innerText;
      const user4Hard30 = document.getElementById('hard30-user4').innerText;
      const user5Hard30 = document.getElementById('hard30-user5').innerText;
      const score1Hard30 = document.getElementById('hard30-score1').innerText;
      const score2Hard30 = document.getElementById('hard30-score2').innerText;
      const score3Hard30 = document.getElementById('hard30-score3').innerText;
      const score4Hard30 = document.getElementById('hard30-score4').innerText;
      const score5Hard30 = document.getElementById('hard30-score5').innerText;
      //HARD 60
      const user1Hard60 = document.getElementById('hard60-user1').innerText;
      const user2Hard60 = document.getElementById('hard60-user2').innerText;
      const user3Hard60 = document.getElementById('hard60-user3').innerText;
      const user4Hard60 = document.getElementById('hard60-user4').innerText;
      const user5Hard60 = document.getElementById('hard60-user5').innerText;
      const score1Hard60 = document.getElementById('hard60-score1').innerText;
      const score2Hard60 = document.getElementById('hard60-score2').innerText;
      const score3Hard60 = document.getElementById('hard60-score3').innerText;
      const score4Hard60 = document.getElementById('hard60-score4').innerText;
      const score5Hard60 = document.getElementById('hard60-score5').innerText;

      //HERO
      const user1Hero = document.getElementById('hero-user1').innerText;
      const user2Hero = document.getElementById('hero-user2').innerText;
      const user3Hero = document.getElementById('hero-user3').innerText;
      const user4Hero = document.getElementById('hero-user4').innerText;
      const user5Hero = document.getElementById('hero-user5').innerText;
      const score1Hero = document.getElementById('hero-score1').innerText;
      const score2Hero = document.getElementById('hero-score2').innerText;
      const score3Hero = document.getElementById('hero-score3').innerText;
      const score4Hero = document.getElementById('hero-score4').innerText;
      const score5Hero = document.getElementById('hero-score5').innerText;

      getDataDB();
      //-----------------------------------------------------------------------------------------SAVE DATA
      function saveDataDB() {
        if (window.vaBene) {
          let totalScore = document.getElementById('final-score').innerText;
          if (+totalScore > 0 && +totalScore < limit) {
            //---------------------------------------------------EASY
            if (window.difficultyName === 'easy' && window.timer === '30') {
              const theBest5Easy30 = [
                score1Easy30,
                score2Easy30,
                score3Easy30,
                score4Easy30,
                score5Easy30,
              ];
              theBest5Easy30.forEach((el) => {
                //se il punteggio finale è superiore ad uno dei punteggi già presenti, lo salvo nel DB
                if (+totalScore > +el) {
                  set(ref(db, `EASY-30-sec/${totalScore}`), {
                    easy30user: nicknameInput.value,
                    easy30score: totalScore,
                  })
                    .then(() => {
                      showSuccess();
                    })
                    .catch((err) => {
                      showError();
                    });
                } else {
                  showSuccess();
                }
              });
            }
            if (window.difficultyName === 'easy' && window.timer === '60') {
              const theBest5Easy60 = [
                score1Easy60,
                score2Easy60,
                score3Easy60,
                score4Easy60,
                score5Easy60,
              ];
              theBest5Easy60.forEach((el) => {
                if (+totalScore > +el) {
                  set(ref(db, `EASY-60-sec/${totalScore}`), {
                    easy60user: nicknameInput.value,
                    easy60score: totalScore,
                  })
                    .then(() => {
                      showSuccess();
                    })
                    .catch((err) => {
                      showError();
                    });
                } else {
                  showSuccess();
                }
              });
            }

            //---------------------------------------------------MEDIUM
            if (window.difficultyName === 'medium' && window.timer === '30') {
              const theBestMedium30 = [
                score1Med30,
                score2Med30,
                score3Med30,
                score4Med30,
                score5Med30,
              ];
              theBestMedium30.forEach((el) => {
                if (+totalScore > +el) {
                  set(ref(db, `MEDIUM-30-sec/${totalScore}`), {
                    medium30user: nicknameInput.value,
                    medium30score: totalScore,
                  })
                    .then(() => {
                      showSuccess();
                    })
                    .catch((err) => {
                      showError();
                    });
                } else {
                  showSuccess();
                }
              });
            }
            if (window.difficultyName === 'medium' && window.timer === '60') {
              const theBestMedium60 = [
                score1Med60,
                score2Med60,
                score3Med60,
                score4Med60,
                score5Med60,
              ];
              theBestMedium60.forEach((el) => {
                if (+totalScore > +el) {
                  set(ref(db, `MEDIUM-60-sec/${totalScore}`), {
                    medium60user: nicknameInput.value,
                    medium60score: totalScore,
                  })
                    .then(() => {
                      showSuccess();
                    })
                    .catch((err) => {
                      showError();
                    });
                } else {
                  showSuccess();
                }
              });
            }

            //---------------------------------------------------HARD
            if (window.difficultyName === 'hard' && window.timer === '30') {
              const theBestHard30 = [
                score1Hard30,
                score2Hard30,
                score3Hard30,
                score4Hard30,
                score5Hard30,
              ];
              theBestHard30.forEach((el) => {
                if (+totalScore > +el) {
                  set(ref(db, `HARD-30-sec/${totalScore}`), {
                    hard30user: nicknameInput.value,
                    hard30score: totalScore,
                  })
                    .then(() => {
                      showSuccess();
                    })
                    .catch((err) => {
                      showError();
                    });
                } else {
                  showSuccess();
                }
              });
            }
            if (window.difficultyName === 'hard' && window.timer === '60') {
              const theBestHard60 = [
                score1Hard60,
                score2Hard60,
                score3Hard60,
                score4Hard60,
                score5Hard60,
              ];
              theBestHard60.forEach((el) => {
                if (+totalScore > +el) {
                  set(ref(db, `HARD-60-sec/${totalScore}`), {
                    hard60user: nicknameInput.value,
                    hard60score: totalScore,
                  })
                    .then(() => {
                      showSuccess();
                    })
                    .catch((err) => {
                      showError();
                    });
                } else {
                  showSuccess();
                }
              });
            }

            //---------------------------------------------------HERO
            if (window.difficultyName === 'hero') {
              const theBestHero = [
                score1Hero,
                score2Hero,
                score3Hero,
                score4Hero,
                score5Hero,
              ];
              theBestHero.forEach((el) => {
                if (+totalScore > +el) {
                  set(ref(db, `HERO/${totalScore}`), {
                    heroUser: nicknameInput.value,
                    heroScore: totalScore,
                  })
                    .then(() => {
                      showSuccess();
                    })
                    .catch((err) => {
                      showError();
                    });
                } else {
                  showSuccess();
                }
              });
            }
          }
        } else {
          window.location.reload();
        }
      }

      function showSuccess() {
        choiseSaveScoreGlobally.style.display = 'none';
        nicknameInput.value = '';
        saveaveScoreGlobally.style.display = 'none';
        successSaveDb.style.display = 'inline-block';
        document.getElementById('start').style.display = 'block';
        setTimeout(() => {
          successSaveDb.style.display = 'none';
        }, limit);
        getDataDB(); //richiamo la get per aggiornare i nuovi punteggi lato client
      }
      function showError() {
        errorSaveDb.style.display = 'inline-block';
        setTimeout(() => {
          errorSaveDb.style.display = 'none';
        }, 4000);
      }

      //-----------------------------------------------------------------------------------------GET DATA
      function getDataDB() {
        const dbref = ref(db);
        //---------------------------------------------------EASY
        get(child(dbref, `EASY-30-sec/`)).then((snapshot) => {
          const easy30Array = [];
          snapshot.forEach((e) => {
            if (e.val().easy30score < limit) easy30Array.push(e.val());
          });
          const easy30sorted = easy30Array.sort((a, b) => {
            if (b.easy30score > a.easy30score) return 1;
            if (a.easy30score > b.easy30score) return -1;
            return 0;
          });

          easy30sorted.forEach((el, i) => {
            const index = i + 1;

            if (index === 1) {
              document.getElementById('easy30-user1').innerText = el.easy30user;
              document.getElementById(
                'easy30-score1'
              ).innerText = ` ${el.easy30score}`;
            }
            if (index === 2) {
              document.getElementById('easy30-user2').innerText = el.easy30user;
              document.getElementById(
                'easy30-score2'
              ).innerText = ` ${el.easy30score}`;
            }
            if (index === 3) {
              document.getElementById('easy30-user3').innerText = el.easy30user;
              document.getElementById(
                'easy30-score3'
              ).innerText = ` ${el.easy30score}`;
            }
            if (index === 4) {
              document.getElementById('easy30-user4').innerText = el.easy30user;
              document.getElementById(
                'easy30-score4'
              ).innerText = ` ${el.easy30score}`;
            }
            if (index === 5) {
              document.getElementById('easy30-user5').innerText = el.easy30user;
              document.getElementById(
                'easy30-score5'
              ).innerText = ` ${el.easy30score}`;
            }
          });
        });

        get(child(dbref, `EASY-60-sec/`)).then((snapshot) => {
          const easy60Array = [];
          snapshot.forEach((e) => {
            if (e.val().easy60score < limit) easy60Array.push(e.val());
          });
          const easy60sorted = easy60Array.sort((a, b) => {
            if (b.easy60score > a.easy60score) return 1;
            if (a.easy60score > b.easy60score) return -1;
            return 0;
          });

          easy60sorted.forEach((el, i) => {
            const index = i + 1;

            if (index === 1) {
              document.getElementById('easy60-user1').innerText = el.easy60user;
              document.getElementById(
                'easy60-score1'
              ).innerText = ` ${el.easy60score}`;
            }
            if (index === 2) {
              document.getElementById('easy60-user2').innerText = el.easy60user;
              document.getElementById(
                'easy60-score2'
              ).innerText = ` ${el.easy60score}`;
            }
            if (index === 3) {
              document.getElementById('easy60-user3').innerText = el.easy60user;
              document.getElementById(
                'easy60-score3'
              ).innerText = ` ${el.easy60score}`;
            }
            if (index === 4) {
              document.getElementById('easy60-user4').innerText = el.easy60user;
              document.getElementById(
                'easy60-score4'
              ).innerText = ` ${el.easy60score}`;
            }
            if (index === 5) {
              document.getElementById('easy60-user5').innerText = el.easy60user;
              document.getElementById(
                'easy60-score5'
              ).innerText = ` ${el.easy60score}`;
            }
          });
        });
        //---------------------------------------------------MEDIUM
        get(child(dbref, `MEDIUM-30-sec/`)).then((snapshot) => {
          const medium30Array = [];
          snapshot.forEach((e) => {
            if (e.val().medium30score < limit) medium30Array.push(e.val());
          });
          const medium30sorted = medium30Array.sort((a, b) => {
            if (b.medium30score > a.medium30score) return 1;
            if (a.medium30score > b.medium30score) return -1;
            return 0;
          });

          medium30sorted.forEach((el, i) => {
            const index = i + 1;

            if (index === 1) {
              document.getElementById('medium30-user1').innerText =
                el.medium30user;
              document.getElementById(
                'medium30-score1'
              ).innerText = ` ${el.medium30score}`;
            }
            if (index === 2) {
              document.getElementById('medium30-user2').innerText =
                el.medium30user;
              document.getElementById(
                'medium30-score2'
              ).innerText = ` ${el.medium30score}`;
            }
            if (index === 3) {
              document.getElementById('medium30-user3').innerText =
                el.medium30user;
              document.getElementById(
                'medium30-score3'
              ).innerText = ` ${el.medium30score}`;
            }
            if (index === 4) {
              document.getElementById('medium30-user4').innerText =
                el.medium30user;
              document.getElementById(
                'medium30-score4'
              ).innerText = ` ${el.medium30score}`;
            }
            if (index === 5) {
              document.getElementById('medium30-user5').innerText =
                el.medium30user;
              document.getElementById(
                'medium30-score5'
              ).innerText = ` ${el.medium30score}`;
            }
          });
        });

        get(child(dbref, `MEDIUM-60-sec/`)).then((snapshot) => {
          const medium60Array = [];
          snapshot.forEach((e) => {
            if (e.val().medium60score < limit) medium60Array.push(e.val());
          });
          const medium60sorted = medium60Array.sort((a, b) => {
            if (b.medium60score > a.medium60score) return 1;
            if (a.medium60score > b.medium60score) return -1;
            return 0;
          });

          medium60sorted.forEach((el, i) => {
            const index = i + 1;

            if (index === 1) {
              document.getElementById('medium60-user1').innerText =
                el.medium60user;
              document.getElementById(
                'medium60-score1'
              ).innerText = ` ${el.medium60score}`;
            }
            if (index === 2) {
              document.getElementById('medium60-user2').innerText =
                el.medium60user;
              document.getElementById(
                'medium60-score2'
              ).innerText = ` ${el.medium60score}`;
            }
            if (index === 3) {
              document.getElementById('medium60-user3').innerText =
                el.medium60user;
              document.getElementById(
                'medium60-score3'
              ).innerText = ` ${el.medium60score}`;
            }
            if (index === 4) {
              document.getElementById('medium60-user4').innerText =
                el.medium60user;
              document.getElementById(
                'medium60-score4'
              ).innerText = ` ${el.medium60score}`;
            }
            if (index === 5) {
              document.getElementById('medium60-user5').innerText =
                el.medium60user;
              document.getElementById(
                'medium60-score5'
              ).innerText = ` ${el.medium60score}`;
            }
          });
        });

        //---------------------------------------------------HARD
        get(child(dbref, `HARD-30-sec/`)).then((snapshot) => {
          const hard30Array = [];
          snapshot.forEach((e) => {
            if (e.val().hard30score < limit) hard30Array.push(e.val());
          });
          const hard30sorted = hard30Array.sort((a, b) => {
            if (b.hard30score > a.hard30score) return 1;
            if (a.hard30score > b.hard30score) return -1;
            return 0;
          });

          hard30sorted.forEach((el, i) => {
            const index = i + 1;

            if (index === 1) {
              document.getElementById('hard30-user1').innerText = el.hard30user;
              document.getElementById(
                'hard30-score1'
              ).innerText = ` ${el.hard30score}`;
            }
            if (index === 2) {
              document.getElementById('hard30-user2').innerText = el.hard30user;
              document.getElementById(
                'hard30-score2'
              ).innerText = ` ${el.hard30score}`;
            }
            if (index === 3) {
              document.getElementById('hard30-user3').innerText = el.hard30user;
              document.getElementById(
                'hard30-score3'
              ).innerText = ` ${el.hard30score}`;
            }
            if (index === 4) {
              document.getElementById('hard30-user4').innerText = el.hard30user;
              document.getElementById(
                'hard30-score4'
              ).innerText = ` ${el.hard30score}`;
            }
            if (index === 5) {
              document.getElementById('hard30-user5').innerText = el.hard30user;
              document.getElementById(
                'hard30-score5'
              ).innerText = ` ${el.hard30score}`;
            }
          });
        });

        get(child(dbref, `HARD-60-sec/`)).then((snapshot) => {
          const hard60Array = [];
          snapshot.forEach((e) => {
            if (e.val().hard60score < limit) hard60Array.push(e.val());
          });
          const hard60sorted = hard60Array.sort((a, b) => {
            if (b.hard60score > a.hard60score) return 1;
            if (a.hard60score > b.hard60score) return -1;
            return 0;
          });

          hard60sorted.forEach((el, i) => {
            const index = i + 1;

            if (index === 1) {
              document.getElementById('hard60-user1').innerText = el.hard60user;
              document.getElementById(
                'hard60-score1'
              ).innerText = ` ${el.hard60score}`;
            }
            if (index === 2) {
              document.getElementById('hard60-user2').innerText = el.hard60user;
              document.getElementById(
                'hard60-score2'
              ).innerText = ` ${el.hard60score}`;
            }
            if (index === 3) {
              document.getElementById('hard60-user3').innerText = el.hard60user;
              document.getElementById(
                'hard60-score3'
              ).innerText = ` ${el.hard60score}`;
            }
            if (index === 4) {
              document.getElementById('hard60-user4').innerText = el.hard60user;
              document.getElementById(
                'hard60-score4'
              ).innerText = ` ${el.hard60score}`;
            }
            if (index === 5) {
              document.getElementById('hard60-user5').innerText = el.hard60user;
              document.getElementById(
                'hard60-score5'
              ).innerText = ` ${el.hard60score}`;
            }
          });
        });

        //--------------------------------------------------------HERO
        get(child(dbref, `HERO/`)).then((snapshot) => {
          const heroArray = [];
          snapshot.forEach((e) => {
            if (e.val().heroScore < limit) heroArray.push(e.val());
          });
          const heroSorted = heroArray.sort((a, b) => {
            if (b.heroScore > a.heroScore) return 1;
            if (a.heroScore > b.heroScore) return -1;
            return 0;
          });

          heroSorted.forEach((el, i) => {
            const index = i + 1;

            if (index === 1) {
              document.getElementById('hero-user1').innerText = el.heroUser;
              document.getElementById(
                'hero-score1'
              ).innerText = ` ${el.heroScore}`;
            }
            if (index === 2) {
              document.getElementById('hero-user2').innerText = el.heroUser;
              document.getElementById(
                'hero-score2'
              ).innerText = ` ${el.heroScore}`;
            }
            if (index === 3) {
              document.getElementById('hero-user3').innerText = el.heroUser;
              document.getElementById(
                'hero-score3'
              ).innerText = ` ${el.heroScore}`;
            }
            if (index === 4) {
              document.getElementById('hero-user4').innerText = el.heroUser;
              document.getElementById(
                'hero-score4'
              ).innerText = ` ${el.heroScore}`;
            }
            if (index === 5) {
              document.getElementById('hero-user5').innerText = el.heroUser;
              document.getElementById(
                'hero-score5'
              ).innerText = ` ${el.heroScore}`;
            }
          });
        });
        console.warn = () => {};
      }

      //DeleteData();
      /* function DeleteData(params) {
        const dbref = ref(db);
        //---------------------------------------------------EASY
        get(child(dbref, `EASY-30-sec/`)).then((snapshot) => {
          const easy30Array = [];
          snapshot.forEach((e) => {
            easy30Array.push(e.val());
          });
          const easy30withoutFirst5 = easy30Array
            .sort((a, b) => {
              if (b.easy30score > a.easy30score) return 1;
              if (a.easy30score > b.easy30score) return -1;
              return 0;
            })
            .splice(5);
          easy30withoutFirst5.forEach((el) => {
            // console.log(el.easy30score);
            remove(el.easy30score);
          });
        });
      } */

      saveGlobalScoreBtn.addEventListener('click', saveDataDB);
      saveGlobalScoreBtn.addEventListener('keypress', function (e) {
        if (e.keyCode === 13) saveDataDB();
      }); //REVIEW: non funziona

      nicknameInput.addEventListener('keyup', (event) => {
        if (event.target.value.length) {
          saveGlobalScoreBtn.disabled = false;
          saveGlobalScoreBtn.style.backgroundColor = 'rgb(61, 214, 0)';
        } else {
          saveGlobalScoreBtn.disabled = true;
          saveGlobalScoreBtn.style.backgroundColor = 'rgb(128, 128, 128)';
        }
      });

      window.oncontextmenu = function () {
        return false;
      };

      document.addEventListener(
        'keydown',
        function (event) {
          var key = event.key || event.keyCode;

          if (key === 123) {
            return false;
          } else if (
            //REVIEW: non funziona
            (event.ctrlKey && event.shiftKey && key === 73) ||
            (event.ctrlKey && event.shiftKey && key === 74) ||
            (event.ctrlKey && event.shiftKey && key === 105) ||
            (event.ctrlKey && event.shiftKey && key === 106)
          ) {
            return false;
          }
        },
        false
      );
    </script>
  </body>
</html>
